{"remainingRequest":"D:\\File\\projects\\bookstore\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\File\\projects\\bookstore\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\File\\projects\\bookstore\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\File\\projects\\bookstore\\vue\\src\\pages\\views\\BookWithUser.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\File\\projects\\bookstore\\vue\\src\\pages\\views\\BookWithUser.vue","mtime":1680846830214},{"path":"D:\\File\\projects\\bookstore\\vue\\babel.config.js","mtime":1676624600000},{"path":"D:\\File\\projects\\bookstore\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\File\\projects\\bookstore\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\File\\projects\\bookstore\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\File\\projects\\bookstore\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7Ci8vIEAgaXMgYW4gYWxpYXMgdG8gL3NyYwppbXBvcnQgcmVxdWVzdCBmcm9tICIuLi8uLi91dGlscy9yZXF1ZXN0IjsKaW1wb3J0IHsgRWxNZXNzYWdlIH0gZnJvbSAiZWxlbWVudC1wbHVzIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgcm91dGVyIGZyb20gIkAvcm91dGVyIjsKZXhwb3J0IGRlZmF1bHQgewogIGNyZWF0ZWQoKSB7CiAgICBsZXQgdXNlclN0ciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSB8fCAie30iOwogICAgdGhpcy51c2VyID0gSlNPTi5wYXJzZSh1c2VyU3RyKTsKICAgIGxldCB1c2VySnNvbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKTsKICAgIGlmICghdXNlckpzb24pIHsKICAgICAgcm91dGVyLnB1c2goIi9sb2dpbiIpOwogICAgfQogICAgdGhpcy5sb2FkKCk7CiAgfSwKICBuYW1lOiAnYm9va3dpdGh1c2VyJywKICBtZXRob2RzOiB7CiAgICBoYW5kbGVsZW5kKGlkLCBpc2JuLCBuYW1lLCBibikgewogICAgICBpZiAodGhpcy5udW1iZXIgPT0gNSkgewogICAgICAgIEVsTWVzc2FnZS53YXJuaW5nKCLmgqjkuI3og73lho3lgJ/pmIXmm7TlpJrnmoTkuabnsY3kuoYiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMubnVtT2ZPdXREYXRhQm9vayAhPSAwKSB7CiAgICAgICAgRWxNZXNzYWdlLndhcm5pbmcoIuWcqOaCqOW9kui/mOmAvuacn+S5puexjeWJjeS4jeiDveWGjeWAn+mYheS5puexjSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5mbGFnID09IGZhbHNlKSB7CiAgICAgICAgRWxNZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICfmgqjmsqHmnInlgJ/pmIXmnYPpmZAs566h55CG5ZGY5a6h5qC46YCa6L+H5ZCO5o6I5p2DJywKICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5mb3JtLnN0YXR1cyA9IDA7CiAgICAgIHRoaXMuZm9ybS5pZCA9IGlkOwogICAgICB0aGlzLmZvcm0uYm9ycm93bnVtID0gYm4gKyAxOwogICAgICBjb25zb2xlLmxvZyhibik7CiAgICAgIHJlcXVlc3QucHV0KCIvYm9vayIsIHRoaXMuZm9ybSkudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCB8fCByZXMuY29kZSA9PSAwKSB7CiAgICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn5YCf6ZiF5oiQ5YqfJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuZm9ybTIuc3RhdHVzID0gIjAiOwogICAgICB0aGlzLmZvcm0yLmlzYm4gPSBpc2JuOwogICAgICB0aGlzLmZvcm0yLmJvb2tuYW1lID0gbmFtZTsKICAgICAgdGhpcy5mb3JtMi5yZWFkZXJJZCA9IHRoaXMudXNlci5pZDsKICAgICAgdGhpcy5mb3JtMi5ib3Jyb3dudW0gPSBibiArIDE7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybTIuYm9ycm93bnVtKTsKICAgICAgY29uc29sZS5sb2codGhpcy51c2VyKTsKICAgICAgbGV0IHN0YXJ0RGF0ZSA9IG1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQoInl5eXktTU0tREQgSEg6bW06c3MiKTsKICAgICAgdGhpcy5mb3JtMi5sZW5kVGltZSA9IHN0YXJ0RGF0ZTsKICAgICAgY29uc29sZS5sb2codGhpcy51c2VyKTsKICAgICAgcmVxdWVzdC5wb3N0KCIvTGVuZFJlY29yZCIsIHRoaXMuZm9ybTIpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgfSk7CiAgICAgIGxldCBmb3JtMyA9IHt9OwogICAgICBmb3JtMy5pc2JuID0gaXNibjsKICAgICAgZm9ybTMuYm9va05hbWUgPSBuYW1lOwogICAgICBmb3JtMy5uaWNrTmFtZSA9IHRoaXMudXNlci51c2VybmFtZTsKICAgICAgZm9ybTMuaWQgPSB0aGlzLnVzZXIuaWQ7CiAgICAgIGZvcm0zLmxlbmR0aW1lID0gc3RhcnREYXRlOwogICAgICBsZXQgbm93RGF0ZSA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSk7CiAgICAgIG5vd0RhdGUuc2V0RGF0ZShub3dEYXRlLmdldERhdGUoKSArIDMwKTsKICAgICAgZm9ybTMuZGVhZHRpbWUgPSBtb21lbnQobm93RGF0ZSkuZm9ybWF0KCJ5eXl5LU1NLUREIEhIOm1tOnNzIik7CiAgICAgIGZvcm0zLnByb2xvbmcgPSAxOwogICAgICByZXF1ZXN0LnBvc3QoIi9ib29rd2l0aHVzZXIvaW5zZXJ0TmV3IiwgZm9ybTMpLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIHRoaXMubG9hZCgpOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuZm9ybXMgPSB2YWw7CiAgICB9LAogICAgZGVsZXRlQmF0Y2goKSB7CiAgICAgIGlmICghdGhpcy5mb3Jtcy5sZW5ndGgpIHsKICAgICAgICBFbE1lc3NhZ2Uud2FybmluZygi6K+36YCJ5oup5pWw5o2u77yBIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vICDkuIDkuKrlsI/kvJjljJbvvIznm7TmjqXlj5HpgIHov5nkuKrmlbDnu4TvvIzogIzkuI3mmK/kuIDkuKrkuIDkuKrnmoTmj5DkuqTlvZLov5gKICAgICAgcmVxdWVzdC5wb3N0KCJib29rd2l0aHVzZXIvZGVsZXRlUmVjb3JkcyIsIHRoaXMuZm9ybXMpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgPT09ICcyMDAnKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygi5om56YeP5b2S6L+Y5oiQ5YqfIik7CiAgICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbG9hZCgpIHsKICAgICAgaWYgKHRoaXMudXNlci5yb2xlID09IDApIHsKICAgICAgICByZXF1ZXN0LmdldCgiL2Jvb2t3aXRodXNlciIsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBwYWdlTnVtOiB0aGlzLmN1cnJlbnRQYWdlLAogICAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgICAgICAgc2VhcmNoMTogdGhpcy5zZWFyY2gxLAogICAgICAgICAgICBzZWFyY2gyOiB0aGlzLnNlYXJjaDIsCiAgICAgICAgICAgIHNlYXJjaDM6IHRoaXMuc2VhcmNoMwogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLnJlY29yZHM7CiAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzLmRhdGEudG90YWw7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVxdWVzdC5nZXQoIi9ib29rd2l0aHVzZXIiLCB7CiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgcGFnZU51bTogdGhpcy5jdXJyZW50UGFnZSwKICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsCiAgICAgICAgICAgIHNlYXJjaDE6IHRoaXMuc2VhcmNoMSwKICAgICAgICAgICAgc2VhcmNoMjogdGhpcy5zZWFyY2gyLAogICAgICAgICAgICBzZWFyY2gzOiB0aGlzLnVzZXIuaWQKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuZGF0YS5yZWNvcmRzOwogICAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLnRvdGFsOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY2xlYXIoKSB7CiAgICAgIHRoaXMuc2VhcmNoMSA9ICIiOwogICAgICB0aGlzLnNlYXJjaDIgPSAiIjsKICAgICAgdGhpcy5zZWFyY2gzID0gIiI7CiAgICAgIHRoaXMubG9hZCgpOwogICAgfSwKICAgIGhhbmRsZURlbGV0ZShyb3cpIHsKICAgICAgY29uc3QgZm9ybTMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJvdykpOwogICAgICByZXF1ZXN0LnBvc3QoImJvb2t3aXRodXNlci9kZWxldGVSZWNvcmQiLCBmb3JtMykudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCB8fCByZXMuY29kZSA9PSAwKSB7CiAgICAgICAgICBFbE1lc3NhZ2Uuc3VjY2Vzcygi5b2S6L+Y5oiQ5YqfIik7CiAgICAgICAgfSBlbHNlIEVsTWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlcmVQcm9sb25nKHJvdykgewogICAgICB2YXIgbm93RGF0ZSA9IG5ldyBEYXRlKHJvdy5kZWFkdGltZSk7CiAgICAgIG5vd0RhdGUuc2V0RGF0ZShub3dEYXRlLmdldERhdGUoKSArIDMwKTsKICAgICAgcm93LmRlYWR0aW1lID0gbW9tZW50KG5vd0RhdGUpLmZvcm1hdCgieXl5eS1NTS1ERCBISDptbTpzcyIpOwogICAgICByb3cucHJvbG9uZyA9IHJvdy5wcm9sb25nIC0gMTsKICAgICAgcmVxdWVzdC5wb3N0KCIvYm9va3dpdGh1c2VyIiwgcm93KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICBpZiAocmVzLmNvZGUgPT0gMjAwIHx8IHJlcy5jb2RlID09IDApIHsKICAgICAgICAgIEVsTWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICfnu63lgJ/miJDlip8nLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfQogICAgICAgIHRoaXMubG9hZCgpOwogICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZTIgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgc2F2ZSgpIHsKICAgICAgLy9FUzbor63ms5UKICAgICAgLy/lnLDlnYAs5L2G5piv77yfSVDkuI7nq6/lj6PvvJ8r6K+35rGC5Y+C5pWwCiAgICAgIC8vIHRoaXMuZm9ybT/ov5nmmK/oh6rliqjkv53lrZjlnKhmb3Jt5Lit55qE77yM6Jm954S25pi+56S65pe25rKh5pyJ5L2/55So77yM5L2G5piv6L+Z5Liq5a+56LGh5Lit5piv5pyJ5a6D55qECiAgICAgIHJlcXVlc3QucG9zdCgiL2Jvb2t3aXRodXNlciIsIHRoaXMuZm9ybSkudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCB8fCByZXMuY29kZSA9PSAwKSB7CiAgICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn5L+u5pS55L+h5oGv5oiQ5YqfJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRWxNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0KICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUyID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZUVkaXQocm93KSB7CiAgICAgIHRoaXMuZm9ybSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocm93KSk7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZTIgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2UocGFnZVNpemUpIHsKICAgICAgdGhpcy5wYWdlU2l6ZSA9IHBhZ2VTaXplOwogICAgICB0aGlzLmxvYWQoKTsKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHBhZ2VOdW0pIHsKICAgICAgdGhpcy5wYWdlTnVtID0gcGFnZU51bTsKICAgICAgdGhpcy5sb2FkKCk7CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybToge30sCiAgICAgIGZvcm0yOiB7fSwKICAgICAgZm9ybTM6IHt9LAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgZGlhbG9nVmlzaWJsZTI6IGZhbHNlLAogICAgICBzZWFyY2gxOiAnJywKICAgICAgc2VhcmNoMjogJycsCiAgICAgIHNlYXJjaDM6ICcnLAogICAgICB0b3RhbDogMTAsCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBwYWdlU2l6ZTogMTAsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIHVzZXI6IHt9LAogICAgICBmb3JtczogW10KICAgIH07CiAgfQp9Ow=="},{"version":3,"names":["request","ElMessage","moment","router","created","userStr","sessionStorage","getItem","user","JSON","parse","userJson","push","load","name","methods","handlelend","id","isbn","bn","number","warning","numOfOutDataBook","flag","message","type","form","status","borrownum","console","log","put","then","res","code","error","msg","form2","bookname","readerId","startDate","Date","format","lendTime","post","form3","bookName","nickName","username","lendtime","nowDate","setDate","getDate","deadtime","prolong","handleSelectionChange","val","forms","deleteBatch","length","success","role","get","params","pageNum","currentPage","pageSize","search1","search2","search3","tableData","data","records","total","clear","handleDelete","row","stringify","handlereProlong","dialogVisible2","save","handleEdit","handleSizeChange","handleCurrentChange","dialogVisible"],"sources":["D:\\File\\projects\\bookstore\\vue\\src\\pages\\views\\BookWithUser.vue"],"sourcesContent":["<template>\n  <div class=\"home\" style=\"padding: 10px\">\n    <!-- 搜索-->\n    <div style=\"margin: 10px 0;\">\n\n      <el-form inline=\"true\" size=\"small\">\n        <el-form-item label=\"图书编号\">\n          <el-input v-model=\"search1\" placeholder=\"请输入图书编号\" clearable>\n            <template #prefix><el-icon class=\"el-input__icon\">\n                <search />\n              </el-icon></template>\n          </el-input>\n        </el-form-item>\n        <el-form-item label=\"图书名称\">\n          <el-input v-model=\"search2\" placeholder=\"请输入图书名称\" clearable>\n            <template #prefix><el-icon class=\"el-input__icon\">\n                <search />\n              </el-icon></template>\n          </el-input>\n        </el-form-item>\n        <el-form-item label=\"借阅者\" v-if=\"user.role == 0\">\n          <el-input v-model=\"search3\" placeholder=\"请输入借阅者昵称\" clearable>\n            <template #prefix><el-icon class=\"el-input__icon\">\n                <search />\n              </el-icon></template>\n          </el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" style=\"margin-left: 1%\" @click=\"load\" size=\"mini\">查询</el-button>\n        </el-form-item>\n        <el-form-item>\n          <el-button size=\"mini\" type=\"danger\" @click=\"clear\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <!-- 按钮-->\n    <div style=\"margin: 10px 0;\">\n      <el-popconfirm title=\"确认归还?\" @confirm=\"deleteBatch\" v-if=\"user.role == 0\">\n        <template #reference>\n          <el-button type=\"danger\" size=\"mini\">批量归还</el-button>\n        </template>\n      </el-popconfirm>\n    </div>\n    <!-- 数据字段-->\n    <el-table :data=\"tableData\" stripe max-height=\"calc(100vh - 265px)\" border=\"true\"\n      @selection-change=\"handleSelectionChange\">\n      <el-table-column v-if=\"user.role == 0\" type=\"selection\" width=\"55\">\n      </el-table-column>\n      <el-table-column prop=\"isbn\" label=\"图书编号\" sortable />\n      <el-table-column prop=\"bookName\" label=\"图书名称\" />\n      <el-table-column prop=\"nickName\" label=\"借阅者\" />\n      <el-table-column prop=\"lendtime\" label=\"借阅时间\" />\n      <el-table-column prop=\"deadtime\" label=\"最迟归还日期\" />\n      <el-table-column prop=\"prolong\" label=\"可续借次数\" />\n      <el-table-column fixed=\"right\" label=\"操作\">\n        <template v-slot=\"scope\">\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row)\" v-if=\"user.role == 0\">修改</el-button>\n          <el-popconfirm title=\"确认归还?\" @confirm=\"handleDelete(scope.row)\" v-if=\"user.role == 0\">\n            <template #reference>\n              <el-button type=\"danger\" size=\"mini\">归还</el-button>\n            </template>\n          </el-popconfirm>\n          <el-popconfirm title=\"确认续借(续借一次延长30天)?\" @confirm=\"handlereProlong(scope.row)\" v-if=\"user.role == 2\"\n            :disabled=\"scope.row.prolong == 0\">\n            <template #reference>\n              <el-button type=\"danger\" size=\"mini\" :disabled=\"scope.row.prolong == 0\">续借</el-button>\n            </template>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--    分页-->\n    <div style=\"margin: 10px 0\">\n      <el-pagination v-model:currentPage=\"currentPage\" :page-sizes=\"[5, 10, 20]\" :page-size=\"pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\" :total=\"total\" @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\">\n      </el-pagination>\n\n      <el-dialog v-model=\"dialogVisible2\" title=\"修改借阅信息\" width=\"30%\">\n        <el-form :model=\"form\" label-width=\"120px\">\n\n          <el-form-item label=\"图书编号\">\n            <el-input style=\"width: 80%\" v-model=\"form.isbn\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"图书名称\">\n            <el-input style=\"width: 80%\" v-model=\"form.bookName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"借阅者\">\n            <el-input style=\"width: 80%\" v-model=\"form.nickName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"续借次数\">\n            <el-input style=\"width: 80%\" v-model=\"form.prolong\"></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n          <span class=\"dialog-footer\">\n            <el-button @click=\"dialogVisible2 = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"save\">确 定</el-button>\n          </span>\n        </template>\n      </el-dialog>\n\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport request from \"../../utils/request\";\nimport { ElMessage } from \"element-plus\";\nimport moment from \"moment\";\nimport router from \"@/router\";\nexport default {\n  created() {\n    let userStr = sessionStorage.getItem(\"user\") || \"{}\"\n    this.user = JSON.parse(userStr)\n    let userJson = sessionStorage.getItem(\"user\")\n    if (!userJson) {\n      router.push(\"/login\")\n    }\n    this.load()\n  },\n  name: 'bookwithuser',\n  methods: {\n\n    handlelend(id, isbn, name, bn) {\n\n      if (this.number == 5) {\n        ElMessage.warning(\"您不能再借阅更多的书籍了\")\n        return;\n      }\n      if (this.numOfOutDataBook != 0) {\n        ElMessage.warning(\"在您归还逾期书籍前不能再借阅书籍\")\n        return;\n      }\n\n      if (this.flag == false) {\n        ElMessage({\n          message: '您没有借阅权限,管理员审核通过后授权',\n          type: 'error',\n        })\n        return;\n      }\n\n      this.form.status = 0\n      this.form.id = id\n      this.form.borrownum = bn + 1\n      console.log(bn)\n      request.put(\"/book\", this.form).then(res => {\n        console.log(res)\n        if (res.code == 200 || res.code == 0) {\n          ElMessage({\n            message: '借阅成功',\n            type: 'success',\n          })\n        }\n        else {\n          ElMessage.error(res.msg)\n        }\n      })\n\n      this.form2.status = \"0\"\n      this.form2.isbn = isbn\n      this.form2.bookname = name\n      this.form2.readerId = this.user.id\n      this.form2.borrownum = bn + 1\n      console.log(this.form2.borrownum)\n      console.log(this.user)\n      let startDate = moment(new Date()).format(\"yyyy-MM-DD HH:mm:ss\");\n      this.form2.lendTime = startDate\n      console.log(this.user)\n      request.post(\"/LendRecord\", this.form2).then(res => {\n        this.load();\n      })\n      let form3 = {};\n      form3.isbn = isbn;\n      form3.bookName = name;\n      form3.nickName = this.user.username;\n      form3.id = this.user.id;\n      form3.lendtime = startDate;\n      let nowDate = new Date(startDate);\n      nowDate.setDate(nowDate.getDate() + 30);\n      form3.deadtime = moment(nowDate).format(\"yyyy-MM-DD HH:mm:ss\");\n      form3.prolong = 1;\n      request.post(\"/bookwithuser/insertNew\", form3).then(res => {\n        console.log(res)\n        this.load()\n      })\n    },\n    handleSelectionChange(val) {\n      this.forms = val\n    },\n    deleteBatch() {\n      if (!this.forms.length) {\n        ElMessage.warning(\"请选择数据！\")\n        return\n      }\n      //  一个小优化，直接发送这个数组，而不是一个一个的提交归还\n      request.post(\"bookwithuser/deleteRecords\", this.forms).then(res => {\n        if (res.code === '200') {\n          ElMessage.success(\"批量归还成功\")\n          this.load()\n        }\n        else {\n          ElMessage.error(res.msg)\n        }\n      })\n    },\n    load() {\n      if (this.user.role == 0) {\n        request.get(\"/bookwithuser\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n            search1: this.search1,\n            search2: this.search2,\n            search3: this.search3,\n          }\n        }).then(res => {\n          console.log(res)\n          this.tableData = res.data.records\n          this.total = res.data.total\n        })\n      }\n      else {\n        request.get(\"/bookwithuser\", {\n          params: {\n            pageNum: this.currentPage,\n            pageSize: this.pageSize,\n            search1: this.search1,\n            search2: this.search2,\n            search3: this.user.id,\n          }\n        }).then(res => {\n          console.log(res)\n          this.tableData = res.data.records\n          this.total = res.data.total\n        })\n      }\n    },\n    clear() {\n      this.search1 = \"\"\n      this.search2 = \"\"\n      this.search3 = \"\"\n      this.load()\n    },\n    handleDelete(row) {\n      const form3 = JSON.parse(JSON.stringify(row))\n      request.post(\"bookwithuser/deleteRecord\", form3).then(res => {\n        console.log(res)\n        if (res.code == 200 || res.code == 0) {\n          ElMessage.success(\"归还成功\")\n        }\n        else\n          ElMessage.error(res.msg)\n        this.load()\n      })\n    },\n    handlereProlong(row) {\n      var nowDate = new Date(row.deadtime);\n      nowDate.setDate(nowDate.getDate() + 30);\n      row.deadtime = moment(nowDate).format(\"yyyy-MM-DD HH:mm:ss\");\n      row.prolong = row.prolong - 1;\n      request.post(\"/bookwithuser\", row).then(res => {\n        console.log(res)\n        if (res.code == 200 || res.code == 0) {\n          ElMessage({\n            message: '续借成功',\n            type: 'success',\n          })\n        }\n        else {\n          ElMessage.error(res.msg)\n        }\n        this.load()\n        this.dialogVisible2 = false\n      })\n    },\n    save() {\n      //ES6语法\n      //地址,但是？IP与端口？+请求参数\n      // this.form?这是自动保存在form中的，虽然显示时没有使用，但是这个对象中是有它的\n      request.post(\"/bookwithuser\", this.form).then(res => {\n        console.log(res)\n        if (res.code == 200 || res.code == 0) {\n          ElMessage({\n            message: '修改信息成功',\n            type: 'success',\n          })\n        }\n        else {\n          ElMessage.error(res.msg)\n        }\n        this.load()\n        this.dialogVisible2 = false\n      })\n    },\n\n    handleEdit(row) {\n      this.form = JSON.parse(JSON.stringify(row))\n      this.dialogVisible2 = true\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize\n      this.load()\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum\n      this.load()\n    },\n\n  },\n  data() {\n    return {\n      form: {},\n      form2: {},\n      form3: {},\n      dialogVisible: false,\n      dialogVisible2: false,\n      search1: '',\n      search2: '',\n      search3: '',\n      total: 10,\n      currentPage: 1,\n      pageSize: 10,\n      tableData: [],\n      user: {},\n      forms: [],\n    }\n  },\n}\n</script>\n"],"mappings":"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"}]}